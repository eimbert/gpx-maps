<div class="load-wrapper">
  <header class="hero">
    <div>
      <h1>Comparte tus GPX</h1>
      <p>Arrastra y suelta hasta {{ maxTracks }} recorridos o pulsa para seleccionarlos.</p>
    </div>
  </header>

  <div
    class="dropzone"
    [class.dropzone--active]="isDragOver"
    (click)="triggerFileDialog()"
    (dragover)="onDragOver($event)"
    (dragleave)="onDragLeave()"
    (drop)="onDrop($event)"
  >
    <input
      #fileInput
      type="file"
      accept=".gpx"
      multiple
      (change)="onFileInputChange($event)"
      hidden
    />

    <div class="dropzone__content">
      <div class="icon">ðŸ“‚</div>
      <p class="title">Suelta aquÃ­ tus archivos GPX</p>
      <p class="subtitle">TambiÃ©n puedes pulsar para abrir el selector</p>
      <button type="button" class="secondary">AÃ±adir archivos</button>
    </div>
  </div>

  <section class="tracks" *ngIf="tracks.length">
    <h2>Tracks cargados</h2>
    <div class="tracks-grid">
      <article class="track-card" *ngFor="let track of tracks; index as i">
        <div class="track-card__header">
          <div class="track-id">{{ i + 1 }}</div>
          <input
            [(ngModel)]="track.name"
            class="track-name"
            [placeholder]="'Track ' + (i + 1)"
          />
          <div class="color-dot" [style.background]="track.color"></div>
          <input class="color-input" type="color" [(ngModel)]="track.color" (change)="updateChartColor(track.chartId, track.color)" aria-label="Color del track" />
          <button type="button" class="ghost" (click)="borrarFichero(i)">Borrar</button>
        </div>

        <div class="track-card__meta">
          <span><strong>Fecha:</strong> {{ track.details.date }}</span>
          <span><strong>Kms:</strong> {{ track.details.distance.toFixed(2) }}</span>
          <span><strong>Ascenso:</strong> {{ track.details.ascent.toFixed(2) }}</span>
        </div>

        <div class="profile-chart">
          <canvas [id]="track.chartId"></canvas>
        </div>
      </article>
    </div>
  </section>

  <button (click)="iniciarVisualizacion()" [disabled]="!tracksCargados()" class="btn-start">
    <span>Iniciar</span>
    <svg aria-hidden="true" focusable="false" viewBox="0 0 24 24" class="btn-start__icon">
      <path d="M5 3l14 9-14 9V3z" fill="currentColor" />
    </svg>
  </button>
</div>
